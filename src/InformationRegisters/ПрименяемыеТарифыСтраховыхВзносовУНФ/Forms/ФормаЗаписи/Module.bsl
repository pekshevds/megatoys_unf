#Область ОбработчикиСобытийФормы

&НаКлиенте
Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	
	Если ИмяСобытия = "ИзмененаТекущаяОрганизация" Тогда
		Если Запись.ИсходныйКлючЗаписи.Пустой() Тогда
			Закрыть();
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Ключ.Пустой() Тогда
		Если Параметры.ЕстьСобственныеДанныеЗаполнения Тогда
			Менеджер = РегистрыСведений.ПрименяемыеТарифыСтраховыхВзносовУНФ.СоздатьМенеджерЗаписи();
			ЗаполнитьЗначенияСвойств(Менеджер, Параметры.СобственныеДанныеЗаполнения);
			Менеджер.Прочитать();
			Если Менеджер.Выбран() Тогда
				ЗначениеВРеквизитФормы(Менеджер, "Запись");
			Иначе
				ЗаполнитьЗначенияСвойств(Запись, Параметры.СобственныеДанныеЗаполнения);
			КонецЕсли;
				
		Иначе
			Запись.ГоловнаяОрганизация = УправлениеНебольшойФирмойПовтИсп.ПолучитьЗначениеПоУмолчаниюПользователя(Пользователи.ТекущийПользователь(), "ОсновнаяОрганизация");
			Если Не ЗначениеЗаполнено(Запись.ГоловнаяОрганизация) Тогда
				Запись.ГоловнаяОрганизация = Справочники.Организации.ПредопределеннаяОрганизация();
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПослеЗаписи(ПараметрыЗаписи)
	
	Оповестить("ИзмененТарифСтраховыхВзносов", Новый Структура("ГоловнаяОрганизация", Запись.ГоловнаяОрганизация));
КонецПроцедуры

#КонецОбласти
