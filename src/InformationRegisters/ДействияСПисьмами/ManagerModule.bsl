#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныйПрограммныйИнтерфейс

Функция ЕстьПеремещенияПисем(УчетнаяЗапись) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ДействияСПисьмами.УчетнаяЗапись КАК УчетнаяЗапись
	|ИЗ
	|	РегистрСведений.ДействияСПисьмами КАК ДействияСПисьмами
	|ГДЕ
	|	ДействияСПисьмами.УчетнаяЗапись = &УчетнаяЗапись";
	Запрос.УстановитьПараметр("УчетнаяЗапись", УчетнаяЗапись);
	Результат = Запрос.Выполнить();
	Возврат Не Результат.Пустой();
	
КонецФункции

Процедура ОчиститьПеремещениеПисем(УчетнаяЗапись) Экспорт
	
	НаборЗаписей = РегистрыСведений.ДействияСПисьмами.СоздатьНаборЗаписей();
	НаборЗаписей.Отбор.УчетнаяЗапись.Установить(УчетнаяЗапись);
	НаборЗаписей.Отбор.Действие.Установить(Перечисления.ДействияСПисьмом.ПеремещениеВПочтовыйЯщик);
	НаборЗаписей.Записать(Истина);
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли
