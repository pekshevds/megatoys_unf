
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ПолеТабличногоДокумента = Параметры.ПереданныйТабличныйДокумент;
	ПредставлениеОтчета = Параметры.ПредставлениеОтчета;
	ЭтаФорма.Заголовок = Параметры.ПредставлениеОтчета;
	Копий = 1;	
КонецПроцедуры

#КонецОбласти
   
#Область ОбработчикиКомандФормы   
   
&НаКлиенте
Процедура Печать(Команда)

	ТабличныеДокументы = Новый СписокЗначений;
	ТабличныеДокументы.Добавить(ПолеТабличногоДокумента, ПредставлениеОтчета);
	ОбъектыПечати = Новый СписокЗначений;
	УправлениеПечатьюКлиент.РаспечататьТабличныеДокументы(ТабличныеДокументы, ОбъектыПечати, Ложь, Копий);
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовФормы

&НаКлиенте
Процедура ПолеТабличногоДокументаОбработкаРасшифровки(Элемент, Расшифровка, СтандартнаяОбработка, ДополнительныеПараметры)
	СтандартнаяОбработка = Ложь;
	Если ТипЗнч(Расшифровка) = Тип("Структура") И Расшифровка.Свойство("ИмяОтчета") Тогда
		ОбработатьРасшифровкуОтчету(Расшифровка);
	КонецЕсли;	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаКлиенте
Процедура ОбработатьРасшифровкуОтчету(Расшифровка)
	Если Расшифровка.ИмяОтчета = "ОтчетЗаСмену" Тогда
		ОбщегоНазначенияРМККлиент.ВывестиРасшифровкуОтчетаЗаСмену(Расшифровка.ДанныеРасшифровки, ЭтаФорма);
	КонецЕсли;	
КонецПроцедуры	

#КонецОбласти
