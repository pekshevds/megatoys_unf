
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ПередЗаписью(Отказ)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли;
	
	ЗаполнитьНаименование();
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ЗаполнитьНаименование()
	
	Если Не ЗначениеЗаполнено(Наименование)
		И СтроковыеФункцииКлиентСерверРФ.ТолькоКириллицаВСтроке(НаименованиеНаСервере) Тогда
		Наименование = НаименованиеНаСервере;
		Возврат;
	КонецЕсли;
	
	ПереименоватьЯщикОтправленные();
	ПереименоватьЯщикВходящие();
	ПереименоватьЯщикИсходящие();
	ПереименоватьЯщикСпам();
	ПереименоватьЯщикУдаленные();
	ПереименоватьЯщикЧерновики();
	
	Если Не ЗначениеЗаполнено(Наименование) Тогда
		Наименование = НаименованиеНаСервере;
	КонецЕсли;
	
КонецПроцедуры

Процедура ПереименоватьЯщикОтправленные()
	
	Если ЗначениеЗаполнено(Наименование) Тогда
		Возврат;
	КонецЕсли;
	
	Если ЭлектроннаяПочтаУНФКлиентСервер.ЭтоЯщикОтправленные(НаименованиеНаСервере) Тогда
		Наименование = НСтр("ru='Отправленные'");
	КонецЕсли;
	
КонецПроцедуры

Процедура ПереименоватьЯщикВходящие()
	
	Если ЗначениеЗаполнено(Наименование) Тогда
		Возврат;
	КонецЕсли;
	
	Если ЭлектроннаяПочтаУНФКлиентСервер.ЭтоЯщикВходящие(НаименованиеНаСервере) Тогда
		Наименование = НСтр("ru='Входящие'");
	КонецЕсли;
	
КонецПроцедуры

Процедура ПереименоватьЯщикСпам()
	
	Если ЗначениеЗаполнено(Наименование) Тогда
		Возврат;
	КонецЕсли;
	
	Если ЭлектроннаяПочтаУНФКлиентСервер.ЭтоЯщикСПАМ(НаименованиеНаСервере) Тогда
		Наименование = НСтр("ru='Спам'");
	КонецЕсли;
	
КонецПроцедуры

Процедура ПереименоватьЯщикЧерновики()
	
	Если ЗначениеЗаполнено(Наименование) Тогда
		Возврат;
	КонецЕсли;
	
	Если ЭлектроннаяПочтаУНФКлиентСервер.ЭтоЯщикЧерновики(НаименованиеНаСервере) Тогда
		Наименование = НСтр("ru='Черновики'");
	КонецЕсли;
	
КонецПроцедуры

Процедура ПереименоватьЯщикУдаленные()
	
	Если ЗначениеЗаполнено(Наименование) Тогда
		Возврат;
	КонецЕсли;
	
	Если ЭлектроннаяПочтаУНФКлиентСервер.ЭтоЯщикУдаленные(НаименованиеНаСервере) Тогда
		Наименование = НСтр("ru='Удаленные'");
	КонецЕсли;
	
КонецПроцедуры

Процедура ПереименоватьЯщикИсходящие()
	
	Если ЗначениеЗаполнено(Наименование) Тогда
		Возврат;
	КонецЕсли;
	
	Если ЭлектроннаяПочтаУНФКлиентСервер.ЭтоЯщикИсходящие(НаименованиеНаСервере) Тогда
		Наименование = НСтр("ru='Исходящие'");
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Иначе
ВызватьИсключение НСтр("ru = 'Недопустимый вызов объекта на клиенте.'");
#КонецЕсли