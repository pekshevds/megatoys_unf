
#Область СлужебныйПрограммныйИнтерфейс

Процедура УдалитьНеотправленныеСообщения() Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	НеотправленныеСообщенияСистемыВзаимодействия.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.НеотправленныеСообщенияСистемыВзаимодействия КАК НеотправленныеСообщенияСистемыВзаимодействия";
	
	Результат = Запрос.Выполнить().Выгрузить();
	Для каждого Сообщение Из Результат Цикл
		СообщениеОбъект = Сообщение.Ссылка.ПолучитьОбъект();
		СообщениеОбъект.Удалить();
	КонецЦикла;
	
КонецПроцедуры

Функция ЕстьНеотправленныеСообщенияПоОбъекту(Ссылка) Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	НеотправленныеСообщенияСистемыВзаимодействия.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.НеотправленныеСообщенияСистемыВзаимодействия КАК НеотправленныеСообщенияСистемыВзаимодействия
	|ГДЕ
	|	НеотправленныеСообщенияСистемыВзаимодействия.ОбсуждениеКонтекст = &ОбсуждениеКонтекст";
	Запрос.УстановитьПараметр("ОбсуждениеКонтекст", Ссылка);
	Результат = Запрос.Выполнить();
	Возврат Не Результат.Пустой();
	
КонецФункции

#КонецОбласти