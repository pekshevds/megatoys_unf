#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

#Область ДляВызоваИзДругихПодсистем


Функция ЭтоОтчетнаяЗадача(Задача) Экспорт
	
	МассивОтчетныхЗадач = Новый Массив;
	
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.ДекларацияПоУСН);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.ДекларацияПоЕНВД);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.Справки2НДФЛ);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.ОтчетностьВПФР);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СреднесписочнаяЧисленность);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.Форма4ФСС);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.Форма6НДФЛ);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.Форма1Предприниматель);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СведенияОЗастрахованныхЛицах);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.РасчетПоСтраховымВзносам);
	МассивОтчетныхЗадач.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СЗВСтаж);
	
	Возврат  МассивОтчетныхЗадач.Найти(Задача) <> Неопределено;
	
КонецФункции


Функция ЭтоРасчетнаяЗадача(Задача) Экспорт
	
	МассивРасчетныхЗадач = КалендарьОтчетностиПовтИсп.ПолучитьМассивРасчетныхЗадач();
	
	Возврат  МассивРасчетныхЗадач.Найти(Задача) <> Неопределено;
	
КонецФункции


Функция ПолучитьМассивЗадачПоСотрудникам(Организация = Неопределено) Экспорт
	
	СистемаНалогооблажениеОрганизации = Неопределено;
	
	Если НЕ Организация = Неопределено Тогда
		СистемаНалогооблажениеОрганизации = 
		РегистрыСведений.СистемыНалогообложенияОрганизаций.ОпределитьСистемуНалогообложенияОрганизации(Организация, ТекущаяДатаСеанса());
	КонецЕсли;
	
	МассивЗадачПоСотрудникам = Новый Массив;
	
	// Задачи по сотрудникам  
	Если НЕ СистемаНалогооблажениеОрганизации = Неопределено И СистемаНалогооблажениеОрганизации.ПрименяетсяАУСН Тогда
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.НалогиСотрудников);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СтраховыеВзносыЗаСотрудников);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СведенияОЗастрахованныхЛицах);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СЗВСтаж);  
	Иначе
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СреднесписочнаяЧисленность);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.НалогиСотрудников); 
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СтраховыеВзносыЗаСотрудников);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.Форма4ФСС);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.ОтчетностьВПФР);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.Справки2НДФЛ);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.Форма6НДФЛ);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СведенияОЗастрахованныхЛицах);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.РасчетПоСтраховымВзносам);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СЗВСтаж); 
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.ПерсСведенияОФизлицах); 
	КонецЕсли;
	
	Возврат  МассивЗадачПоСотрудникам;
	
КонецФункции   

Функция ПолучитьМассивЗадачДляАУСН(Организация = Неопределено) Экспорт
	
	СистемаНалогооблажениеОрганизации = Неопределено;
	
	Если НЕ Организация = Неопределено Тогда
		СистемаНалогооблажениеОрганизации = 
		РегистрыСведений.СистемыНалогообложенияОрганизаций.ОпределитьСистемуНалогообложенияОрганизации(Организация, ТекущаяДатаСеанса());
	КонецЕсли;
	
	МассивЗадачПоСотрудникам = Новый Массив;
	
	// Задачи по сотрудникам  
	Если НЕ СистемаНалогооблажениеОрганизации = Неопределено И СистемаНалогооблажениеОрганизации.ПрименяетсяАУСН Тогда
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.НалогАУСН);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.НалогиСотрудников);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СтраховыеВзносыЗаСотрудников);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СведенияОЗастрахованныхЛицах);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.СЗВСтаж);  
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.Декларация8);
		МассивЗадачПоСотрудникам.Добавить(Справочники.ЗадачиКалендаряПодготовкиОтчетности.ТорговыйСбор);
	КонецЕсли;
	
	Возврат  МассивЗадачПоСотрудникам;
	
КонецФункции

// Возвращает реквизиты справочника, которые образуют естественный ключ
//  для элементов справочника.
//
// Возвращаемое значение: Массив(Строка) - массив имен реквизитов, образующих
//  естественный ключ.
//
Функция ПоляЕстественногоКлюча() Экспорт
	
	Результат = Новый Массив();
	
	Результат.Добавить("Наименование");
	Результат.Добавить("ПометкаУдаления");
	
	Возврат Результат;
	
КонецФункции

#КонецОбласти

#КонецОбласти

#КонецЕсли