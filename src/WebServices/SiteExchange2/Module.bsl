
#Область ПрограммныйИнтерфейс

Функция GetItems(ModificationDate, GroupCode, SettingsExchangeCode = Неопределено) Экспорт
	
	Если ИнтеграцияСИнтернетМагазиномПовтИсп.ИспользоватьИнтеграциюСИнтернетМагазином() Тогда
		
		Попытка
			
			Возврат ИнтеграцияСИнтернетМагазиномСервер.ПолучитьКлассификаторИКаталогВебСервис(ModificationDate, GroupCode, SettingsExchangeCode);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации("ИнтеграцияСИнтернетМагазином.SiteExchange2.GetItems",
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	Иначе
		
		Попытка
			
			Возврат ОбменССайтомВебСервер.ПолучитьКлассификаторИКаталог(ModificationDate, GroupCode, SettingsExchangeCode);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации(НСтр("ru = 'Обмен с сайтом веб-сервис SiteExchange2.GetItems'"),
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	КонецЕсли;
	
КонецФункции

Функция GetAmountAndPrices(ModificationDate, GroupCode, WarehouseCode, OrganizationCode, SettingsExchangeCode = Неопределено) Экспорт
	
	Если ИнтеграцияСИнтернетМагазиномПовтИсп.ИспользоватьИнтеграциюСИнтернетМагазином() Тогда
		
		Попытка
			
			Возврат ИнтеграцияСИнтернетМагазиномСервер.ПолучитьОстаткиИЦеныВебСервис(ModificationDate, GroupCode, WarehouseCode, OrganizationCode, SettingsExchangeCode);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации("ИнтеграцияСИнтернетМагазином.SiteExchange2.GetAmountAndPrices",
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	Иначе
		
		Попытка
			
			Возврат ОбменССайтомВебСервер.ПолучитьОстаткиИЦены(ModificationDate, GroupCode, WarehouseCode, OrganizationCode, SettingsExchangeCode);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации(НСтр("ru = 'Обмен с сайтом веб-сервис SiteExchange2.GetAmountAndPrices'"),
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	КонецЕсли;
	
КонецФункции

Функция GetOrders(ModificationDate, SettingsExchangeCode = Неопределено) Экспорт
	
	Если ИнтеграцияСИнтернетМагазиномПовтИсп.ИспользоватьИнтеграциюСИнтернетМагазином() Тогда
		
		Попытка
			
			Возврат ИнтеграцияСИнтернетМагазиномСервер.ПолучитьЗаказыВебСервис(ModificationDate, SettingsExchangeCode);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации("ИнтеграцияСИнтернетМагазином.SiteExchange2.GetOrders",
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	Иначе
		
		Попытка
			
			Возврат ОбменССайтомВебСервер.ПолучитьЗаказы(ModificationDate, SettingsExchangeCode);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации(НСтр("ru = 'Обмен с сайтом веб-сервис SiteExchange2.GetOrders'"),
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	КонецЕсли;
	
КонецФункции

Функция LoadOrders(OrdersData, SettingsExchangeCode = Неопределено) Экспорт
	
	Если ИнтеграцияСИнтернетМагазиномПовтИсп.ИспользоватьИнтеграциюСИнтернетМагазином() Тогда
		
		Попытка
			
			Возврат ИнтеграцияСИнтернетМагазиномСервер.ЗагрузитьЗаказыВебСервис(OrdersData, SettingsExchangeCode);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации("ИнтеграцияСИнтернетМагазином.SiteExchange2.LoadOrders",
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	Иначе
		
		Попытка
			
			Возврат ОбменССайтомВебСервер.ЗагрузитьЗаказы(OrdersData, SettingsExchangeCode);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации(НСтр("ru = 'Обмен с сайтом веб-сервис SiteExchange2.LoadOrders'"),
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	КонецЕсли;
	
КонецФункции

Функция GetPicture(ItemID, SettingsExchangeCode = Неопределено) Экспорт
	
	Если ИнтеграцияСИнтернетМагазиномПовтИсп.ИспользоватьИнтеграциюСИнтернетМагазином() Тогда
		
		Попытка
			
			Возврат ИнтеграцияСИнтернетМагазиномСервер.ПолучитьКартинкуВебСервис(ItemID);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации("ИнтеграцияСИнтернетМагазином.SiteExchange2.GetPicture",
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	Иначе
		
		Попытка
			
			Возврат ОбменССайтомВебСервер.ПолучитьКартинку(ItemID);
			
		Исключение
			
			ПредставлениеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			
			ЗаписьЖурналаРегистрации(НСтр("ru = 'Обмен с сайтом веб-сервис SiteExchange2.GetPicture'"),
			УровеньЖурналаРегистрации.Ошибка,,, ПредставлениеОшибки);
			ВызватьИсключение ПредставлениеОшибки;
			
		КонецПопытки;
		
	КонецЕсли;
	
КонецФункции

#КонецОбласти