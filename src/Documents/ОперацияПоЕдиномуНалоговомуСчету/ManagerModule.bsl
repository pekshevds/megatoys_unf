#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

Функция ВремяДокументаПоУмолчанию() Экспорт
	
	Возврат Новый Структура("Часы, Минуты", 21, 0);
	
КонецФункции

#Область ДляВызоваИзДругихПодсистем

// СтандартныеПодсистемы.УправлениеДоступом

// См. УправлениеДоступомПереопределяемый.ПриЗаполненииСписковСОграничениемДоступа.
Процедура ПриЗаполненииОграниченияДоступа(Ограничение) Экспорт

	Ограничение.Текст =
	"РазрешитьЧтениеИзменение
	|ГДЕ
	|	ЗначениеРазрешено(Организация)";

КонецПроцедуры

// Конец СтандартныеПодсистемы.УправлениеДоступом

#КонецОбласти

#КонецОбласти

#Область ОбработчикиСобытий

Процедура ОбработкаПолученияФормы(ВидФормы, Параметры, ВыбраннаяФорма, ДополнительнаяИнформация, СтандартнаяОбработка)
	
	Если ВидФормы <> "ФормаДокумента"
		И ВидФормы <> "ФормаОбъекта" Тогда
		Возврат;
	КонецЕсли;

	Если Параметры.Свойство("Ключ") И ЗначениеЗаполнено(Параметры.Ключ) Тогда
		СтандартнаяОбработка = Ложь;
		ВыбраннаяФорма = "ФормаДокумента";
	ИначеЕсли Параметры.Свойство("ЗначениеКопирования") И ЗначениеЗаполнено(Параметры.ЗначениеКопирования) Тогда
		СтандартнаяОбработка = Ложь;
		ВыбраннаяФорма = "ФормаДокумента";
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

// СтандартныеПодсистемы.ВерсионированиеОбъектов

// Определяет настройки объекта для подсистемы ВерсионированиеОбъектов.
//
// Параметры:
//   Настройки - Структура - настройки подсистемы.
//
Процедура ПриОпределенииНастроекВерсионированияОбъектов(Настройки) Экспорт
	
КонецПроцедуры

// Конец СтандартныеПодсистемы.ВерсионированиеОбъектов

#Область Печать

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати.
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт

КонецПроцедуры

// Формирует печатные формы.
//
// Параметры:
//  МассивОбъектов - Массив - ссылки на объекты, которые нужно распечатать;
//  ПараметрыПечати - Структура - дополнительные настройки печати;
//  КоллекцияПечатныхФорм - ТаблицаЗначений - сформированные табличные документы (выходной параметр)
//  ОбъектыПечати - СписокЗначений - значение - ссылка на объект.
//                                            представление - имя области, в которой был выведен объект (выходной параметр);
//  ПараметрыВывода - Структура - дополнительные параметры сформированных табличных документов (выходной параметр).
//
Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт

КонецПроцедуры

Функция ОписаниеДокумента(ДокументСсылка) Экспорт
	
	ОписаниеДокумента = Новый Структура("Наименование, Сумма");
	
	Если ЗначениеЗаполнено(ДокументСсылка) Тогда
		РеквизитыДокумента    = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(ДокументСсылка,
			"Номер, Дата, СуммаДокумента");
		
		НаименованиеДокумента = ДокументСсылка.Метаданные().Синоним;
		НомерДокумента        = ПрефиксацияОбъектовКлиентСервер.НомерНаПечать(РеквизитыДокумента.Номер, Истина, Истина);
		ДатаДокумента         = Формат(РеквизитыДокумента.Дата,"ДЛФ=D");
		
		ШаблонПредставления = НСтр("ru = '%1 %2 от %3'");
		
		ОписаниеДокумента.Наименование = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(ШаблонПредставления,
			НаименованиеДокумента, НомерДокумента, ДатаДокумента);
		ОписаниеДокумента.Сумма = РеквизитыДокумента.СуммаДокумента;
	КонецЕсли;
	
	Возврат ОписаниеДокумента;
	
КонецФункции

// Определяет список команд заполнения.
//
// Параметры:
//   КомандыЗаполнения - ТаблицаЗначений - Таблица с командами заполнения. Для изменения.
//       См. описание 1 параметра процедуры ЗаполнениеОбъектовПереопределяемый.ПередДобавлениемКомандЗаполнения().
//   Параметры - Структура - Вспомогательные параметры. Для чтения.
//       См. описание 2 параметра процедуры ЗаполнениеОбъектовПереопределяемый.ПередДобавлениемКомандЗаполнения().
//
//@skip-warning
Процедура ДобавитьКомандыЗаполнения(КомандыЗаполнения, Параметры) Экспорт
	
КонецПроцедуры

#КонецОбласти

#Область ПроведениеДокумента

Функция ПодготовитьПараметрыПроведения(ДокументСсылка, Отказ) Экспорт
	
	ПараметрыПроведения = Новый Структура;
	ПараметрыПроведения.Вставить("ДокументСсылка", ДокументСсылка);
	
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Запрос.УстановитьПараметр("Ссылка",                    ДокументСсылка);
	
	ПодготовитьПараметрыРеквизитыДокумента(Запрос, ПараметрыПроведения, Отказ);
	
	Реквизиты = ПараметрыПроведения.ТаблицаРеквизиты[0];
	Если Отказ ИЛИ НЕ ПрослеживаемостьПереопределяемый.УчетнаяПолитикаСуществует(Реквизиты.Организация, Реквизиты.Период, Истина, ДокументСсылка) Тогда
		Отказ = Истина;
		Возврат ПараметрыПроведения;
	КонецЕсли;
	
	Для Каждого Колонка Из ПараметрыПроведения.ТаблицаРеквизиты.Колонки Цикл
		Запрос.УстановитьПараметр(Колонка.Имя, Реквизиты[Колонка.Имя]);
	КонецЦикла;
	
	НомераТаблиц = Новый Структура;
	
	Запрос.Текст = ТекстЗапросаРеквизитыДокумента(НомераТаблиц)
		+ ТекстЗапросаНачислениеНалогов(НомераТаблиц, ПараметрыПроведения, Реквизиты)
		+ ТекстЗапросаУплатаНалогов(НомераТаблиц, ПараметрыПроведения, Реквизиты)
		+ ТекстЗапросаНачислениеПенейШтрафов(НомераТаблиц, ПараметрыПроведения, Реквизиты)
		+ ТекстЗапросаПогашениеПенейШтрафов(НомераТаблиц, ПараметрыПроведения, Реквизиты)
		+ ТекстЗапросаНалоговыйАгентНДС(НомераТаблиц, ПараметрыПроведения, Реквизиты)
		+ ТекстЗапросаПополнениеСчета(НомераТаблиц, ПараметрыПроведения, Реквизиты)
		+ ТекстЗапросаСписаниеСоСчета(НомераТаблиц, ПараметрыПроведения, Реквизиты);
	Результат = Запрос.ВыполнитьПакет();

	Для каждого НомерТаблицы Из НомераТаблиц Цикл
		ПараметрыПроведения.Вставить(НомерТаблицы.Ключ, Результат[НомерТаблицы.Значение].Выгрузить());
	КонецЦикла;
	
	Возврат ПараметрыПроведения;
	
КонецФункции

Процедура ПодготовитьПараметрыРеквизитыДокумента(Запрос, ПараметрыПроведения, Отказ)
	
	Запрос.Текст =
	"ВЫБРАТЬ
	|	Реквизиты.Ссылка КАК Ссылка,
	|	Реквизиты.Номер КАК Номер,
	|	Реквизиты.Дата КАК Дата,
	|	Реквизиты.Проведен КАК Проведен,
	|	Реквизиты.Организация КАК Организация,
	|	Реквизиты.ВидОперации КАК ВидОперации,
	|	Реквизиты.СуммаДокумента КАК СуммаДокумента
	|ПОМЕСТИТЬ Реквизиты
	|ИЗ
	|	Документ.ОперацияПоЕдиномуНалоговомуСчету КАК Реквизиты
	|ГДЕ
	|	Реквизиты.Ссылка = &Ссылка
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	Реквизиты.Ссылка КАК Ссылка,
	|	Реквизиты.Номер КАК Номер,
	|	Реквизиты.Дата КАК Период,
	|	Реквизиты.Проведен КАК Проведен,
	|	Реквизиты.Организация КАК Организация,
	|	Реквизиты.ВидОперации КАК ВидОперации,
	|	Реквизиты.СуммаДокумента КАК СуммаДокумента
	|ИЗ
	|	Реквизиты КАК Реквизиты";
	
	ТаблицаРеквизиты = Запрос.Выполнить().Выгрузить();
	
	ПараметрыПроведения.Вставить("ТаблицаРеквизиты", ТаблицаРеквизиты);
	
КонецПроцедуры

Функция ТекстЗапросаРеквизитыДокумента(НомераТаблиц)

	НомераТаблиц.Вставить("Реквизиты", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	Реквизиты.Ссылка КАК Регистратор,
	|	Реквизиты.Дата КАК Период,
	|	Реквизиты.ВидОперации КАК ВидОперации,
	|	Реквизиты.Организация КАК Организация
	|ИЗ
	|	Реквизиты КАК Реквизиты";

	Возврат ТекстЗапроса + ОбщегоНазначенияУНФКлиентСервер.ТекстРазделителяЗапросовПакета();

КонецФункции

Функция ТекстЗапросаНачислениеНалогов(НомераТаблиц, ПараметрыПроведения, Реквизиты)
	
	Если Реквизиты.ВидОперации <> Перечисления.ВидыОперацийПоЕдиномуНалоговомуСчету.НачислениеНалогов Тогда
		ПараметрыПроведения.Вставить("НачислениеНалогов", Неопределено);
		Возврат "";
	КонецЕсли;
	
	НомераТаблиц.Вставить("НачислениеНалогов", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.Ссылка КАК Ссылка,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.Налог КАК Налог,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.КодБК КАК КодБК,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.СчетУчета КАК СчетУчета,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.РегистрацияВНалоговомОргане КАК РегистрацияВНалоговомОргане,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.КодПоОКТМО КАК КодПоОКТМО,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.Сумма КАК Сумма,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.СрокУплаты КАК СрокУплаты,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.ПлатежныйДокумент КАК ПлатежныйДокумент,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.НомерСтроки КАК НомерСтроки,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.КорректировкаЕНС КАК КорректировкаЕНС
	|ИЗ
	|	Документ.ОперацияПоЕдиномуНалоговомуСчету.Налоги КАК ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги
	|ГДЕ
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговНалоги.Ссылка = &Ссылка";

	Возврат ТекстЗапроса + ОбщегоНазначенияУНФКлиентСервер.ТекстРазделителяЗапросовПакета();

КонецФункции

Функция ТекстЗапросаУплатаНалогов(НомераТаблиц, ПараметрыПроведения, Реквизиты)
	
	Если Реквизиты.ВидОперации <> Перечисления.ВидыОперацийПоЕдиномуНалоговомуСчету.УплатаНалогов Тогда
		ПараметрыПроведения.Вставить("УплатаНалогов", Неопределено);
		Возврат "";
	КонецЕсли;
	
	НомераТаблиц.Вставить("УплатаНалогов", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.Ссылка КАК Ссылка,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.Налог КАК Налог,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.КодБК КАК КодБК,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.СчетУчета КАК СчетУчета,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.РегистрацияВНалоговомОргане КАК РегистрацияВНалоговомОргане,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.КодПоОКТМО КАК КодПоОКТМО,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.Сумма КАК Сумма,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.СрокУплаты КАК СрокУплаты,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.ПлатежныйДокумент КАК ПлатежныйДокумент,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.НомерСтроки КАК НомерСтроки,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.СчетЗатрат КАК СчетЗатрат,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.УчитыватьВНУ КАК УчитыватьВНУ,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.Подразделение КАК Подразделение,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) КАК ВидДвижения,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.КорректировкаЕНС КАК КорректировкаЕНС
	|ИЗ
	|	Документ.ОперацияПоЕдиномуНалоговомуСчету.Налоги КАК ОперацияПоЕдиномуНалоговомуСчетуНалоги
	|ГДЕ
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.Ссылка = &Ссылка";

	Возврат ТекстЗапроса + ОбщегоНазначенияУНФКлиентСервер.ТекстРазделителяЗапросовПакета();

КонецФункции

Функция ТекстЗапросаНачислениеПенейШтрафов(НомераТаблиц, ПараметрыПроведения, Реквизиты)
	
	Если Реквизиты.ВидОперации <> Перечисления.ВидыОперацийПоЕдиномуНалоговомуСчету.НачислениеПенейШтрафов Тогда
		ПараметрыПроведения.Вставить("НачислениеПенейШтрафов", Неопределено);
		Возврат "";
	КонецЕсли;
	
	НомераТаблиц.Вставить("НачислениеПенейШтрафов", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.Ссылка КАК Ссылка,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.НомерСтроки КАК НомерСтроки,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.ВидПлатежа КАК ВидПлатежа,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.Сумма КАК Сумма,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.ПлатежныйДокумент КАК ПлатежныйДокумент,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.УчитыватьВНУ КАК УчитыватьВНУ,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.Подразделение КАК Подразделение,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения
	|ИЗ
	|	Документ.ОперацияПоЕдиномуНалоговомуСчету.Санкции КАК ОперацияПоЕдиномуНалоговомуСчетуСанкции
	|ГДЕ
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.Ссылка = &Ссылка";

	Возврат ТекстЗапроса + ОбщегоНазначенияУНФКлиентСервер.ТекстРазделителяЗапросовПакета();

КонецФункции

Функция ТекстЗапросаПогашениеПенейШтрафов(НомераТаблиц, ПараметрыПроведения, Реквизиты)
	
	Если Реквизиты.ВидОперации <> Перечисления.ВидыОперацийПоЕдиномуНалоговомуСчету.ПогашениеПенейШтрафов Тогда
		ПараметрыПроведения.Вставить("ПогашениеПенейШтрафов", Неопределено);
		Возврат "";
	КонецЕсли;
	
	НомераТаблиц.Вставить("ПогашениеПенейШтрафов", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.Ссылка КАК Ссылка,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.НомерСтроки КАК НомерСтроки,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.ВидПлатежа КАК ВидПлатежа,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.Сумма КАК Сумма,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.ПлатежныйДокумент КАК ПлатежныйДокумент,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.УчитыватьВНУ КАК УчитыватьВНУ,
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.Подразделение КАК Подразделение,
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) КАК ВидДвижения
	|ИЗ
	|	Документ.ОперацияПоЕдиномуНалоговомуСчету.Санкции КАК ОперацияПоЕдиномуНалоговомуСчетуСанкции
	|ГДЕ
	|	ОперацияПоЕдиномуНалоговомуСчетуСанкции.Ссылка = &Ссылка";

	Возврат ТекстЗапроса + ОбщегоНазначенияУНФКлиентСервер.ТекстРазделителяЗапросовПакета();

КонецФункции

Функция ТекстЗапросаНалоговыйАгентНДС(НомераТаблиц, ПараметрыПроведения, Реквизиты)
	
	Если Реквизиты.ВидОперации <> Перечисления.ВидыОперацийПоЕдиномуНалоговомуСчету.НачислениеНалогов Тогда
		ПараметрыПроведения.Вставить("НалоговыйАгентНДС", Неопределено);
		Возврат "";
	КонецЕсли;
	
	НомераТаблиц.Вставить("НалоговыйАгентНДС", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.Ссылка КАК Ссылка,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.НомерСтроки КАК НомерСтроки,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.Контрагент КАК Контрагент,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.Договор КАК Договор,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.ДокументРасчетов КАК ДокументРасчетов,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.Сумма КАК Сумма,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.СчетУчета КАК СчетУчета,
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоги.Налог КАК Налог
	|ИЗ
	|	Документ.ОперацияПоЕдиномуНалоговомуСчету.НалоговыйАгентНДС КАК ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС
	|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОперацияПоЕдиномуНалоговомуСчету.Налоги КАК ОперацияПоЕдиномуНалоговомуСчетуНалоги
	|		ПО ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.КлючСтроки = ОперацияПоЕдиномуНалоговомуСчетуНалоги.КлючСтроки
	|			И ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.Ссылка = ОперацияПоЕдиномуНалоговомуСчетуНалоги.Ссылка
	|ГДЕ
	|	ОперацияПоЕдиномуНалоговомуСчетуНалоговыйАгентНДС.Ссылка = &Ссылка
	|	И ОперацияПоЕдиномуНалоговомуСчетуНалоги.Ссылка = &Ссылка";

	Возврат ТекстЗапроса + ОбщегоНазначенияУНФКлиентСервер.ТекстРазделителяЗапросовПакета();

КонецФункции

Функция ТекстЗапросаПополнениеСчета(НомераТаблиц, ПараметрыПроведения, Реквизиты)
	
	Если Реквизиты.ВидОперации <> Перечисления.ВидыОперацийПоЕдиномуНалоговомуСчету.КорректировкаСчета Тогда
		ПараметрыПроведения.Вставить("ПополнениеСчета", Неопределено);
		Возврат "";
	КонецЕсли;
	
	НомераТаблиц.Вставить("ПополнениеСчета", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход) КАК ВидДвижения,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Ссылка КАК Ссылка,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.НомерСтроки КАК НомерСтроки,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Сумма КАК Сумма,
	|	ВЫБОР
	|		КОГДА ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.ПлатежныйДокумент = НЕОПРЕДЕЛЕНО
	|			ТОГДА ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Ссылка
	|		ИНАЧЕ ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.ПлатежныйДокумент
	|	КОНЕЦ КАК ПлатежныйДокумент,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.УчитыватьВНУ КАК УчитыватьВНУ,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Подразделение КАК Подразделение
	|ИЗ
	|	Документ.ОперацияПоЕдиномуНалоговомуСчету.ЕдиныйСчет КАК ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет
	|ГДЕ
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Ссылка = &Ссылка
	|	И НЕ ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.ВидДвижения";

	Возврат ТекстЗапроса + ОбщегоНазначенияУНФКлиентСервер.ТекстРазделителяЗапросовПакета();

КонецФункции

Функция ТекстЗапросаСписаниеСоСчета(НомераТаблиц, ПараметрыПроведения, Реквизиты)
	
	Если Реквизиты.ВидОперации <> Перечисления.ВидыОперацийПоЕдиномуНалоговомуСчету.КорректировкаСчета Тогда
		ПараметрыПроведения.Вставить("СписаниеСоСчета", Неопределено);
		Возврат "";
	КонецЕсли;
	
	НомераТаблиц.Вставить("СписаниеСоСчета", НомераТаблиц.Количество());
	
	ТекстЗапроса =
	"ВЫБРАТЬ
	|	ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход) КАК ВидДвижения,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Ссылка КАК Ссылка,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.НомерСтроки КАК НомерСтроки,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Сумма КАК Сумма,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.ПлатежныйДокумент КАК ПлатежныйДокумент,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.СчетЗатрат КАК СчетЗатрат,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.УчитыватьВНУ КАК УчитыватьВНУ,
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Подразделение КАК Подразделение
	|ИЗ
	|	Документ.ОперацияПоЕдиномуНалоговомуСчету.ЕдиныйСчет КАК ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет
	|ГДЕ
	|	ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.Ссылка = &Ссылка
	|	И ОперацияПоЕдиномуНалоговомуСчетуЕдиныйСчет.ВидДвижения";

	Возврат ТекстЗапроса + ОбщегоНазначенияУНФКлиентСервер.ТекстРазделителяЗапросовПакета();

КонецФункции

#КонецОбласти

#КонецОбласти

#КонецЕсли