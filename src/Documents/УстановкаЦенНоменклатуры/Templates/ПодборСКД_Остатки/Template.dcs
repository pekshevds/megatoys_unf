<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>НаборДанных1</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Организация остатков</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтруктурнаяЕдиница</dataPath>
			<field>СтруктурнаяЕдиница</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаОстаток</dataPath>
			<field>СуммаОстаток</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Остаток на складе (сумма)</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Характеристика</dataPath>
			<field>Характеристика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Партия</dataPath>
			<field>Партия</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Партия остатков</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЗаказПокупателя</dataPath>
			<field>ЗаказПокупателя</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЗаказНаПроизводство</dataPath>
			<field>ЗаказНаПроизводство</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СчетУчета</dataPath>
			<field>СчетУчета</field>
			<useRestriction>
				<condition>true</condition>
			</useRestriction>
			<attributeUseRestriction>
				<condition>true</condition>
			</attributeUseRestriction>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЕдиницаИзмерения</dataPath>
			<field>ЕдиницаИзмерения</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Единица измерения</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Склад</dataPath>
			<field>Склад</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Склад остатков</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
			<valueType>
				<v8:Type xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:CatalogRef.СтруктурныеЕдиницы</v8:Type>
			</valueType>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоОстаток</dataPath>
			<field>КоличествоОстаток</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Остаток на складе (количество)</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЦеноваяГруппа</dataPath>
			<field>ЦеноваяГруппа</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Ценовая группа</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПоследняяДатаУстановкиЦены</dataPath>
			<field>ПоследняяДатаУстановкиЦены</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Последняя дата установки цены</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидЦен</dataPath>
			<field>ВидЦен</field>
			<valueType>
				<v8:Type xmlns:d5p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d5p1:CatalogRef.ВидыЦен</v8:Type>
			</valueType>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>УстановленаЦенаПоВидуЦен</dataPath>
			<field>УстановленаЦенаПоВидуЦен</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Установлена цена по виду цен</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КатегорияНоменклатуры</dataPath>
			<field>КатегорияНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Категория номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ
	Номенклатура.Ссылка КАК Ссылка,
	Номенклатура.ИспользоватьХарактеристики КАК ИспользоватьХарактеристики,
	Номенклатура.КатегорияНоменклатуры КАК КатегорияНоменклатуры
ПОМЕСТИТЬ НоменклатураИерархия
ИЗ
	Справочник.Номенклатура КАК Номенклатура
ГДЕ
	НЕ Номенклатура.ЭтоГруппа
	И Номенклатура.Недействителен = ЛОЖЬ
	И Номенклатура.ТипНоменклатуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.ПодарочныйСертификат)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Номенклатура.Ссылка КАК Ссылка,
	Номенклатура.ИспользоватьХарактеристики КАК ИспользоватьХарактеристики,
	Номенклатура.КатегорияНоменклатуры КАК КатегорияНоменклатуры
ПОМЕСТИТЬ НоменклатураСсылки
ИЗ
	Справочник.Номенклатура КАК Номенклатура
ГДЕ
	НЕ Номенклатура.ЭтоГруппа
	И Номенклатура.Недействителен = ЛОЖЬ
	И Номенклатура.ТипНоменклатуры &lt;&gt; ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.ПодарочныйСертификат)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НоменклатураИерархия.Ссылка КАК Ссылка,
	НоменклатураИерархия.ИспользоватьХарактеристики КАК ИспользоватьХарактеристики,
	НоменклатураИерархия.КатегорияНоменклатуры КАК КатегорияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка) КАК Характеристика
ПОМЕСТИТЬ ТаблицаНоменклатуры
ИЗ
	НоменклатураИерархия КАК НоменклатураИерархия

ОБЪЕДИНИТЬ

ВЫБРАТЬ
	НоменклатураСсылки.Ссылка,
	НоменклатураСсылки.ИспользоватьХарактеристики,
	НоменклатураСсылки.КатегорияНоменклатуры,
	ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)
ИЗ
	НоменклатураСсылки КАК НоменклатураСсылки

ИНДЕКСИРОВАТЬ ПО
	Ссылка,
	КатегорияНоменклатуры
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаНоменклатуры.Ссылка КАК Ссылка,
	ТаблицаНоменклатуры.ИспользоватьХарактеристики КАК ИспользоватьХарактеристики,
	ТаблицаНоменклатуры.КатегорияНоменклатуры КАК КатегорияНоменклатуры,
	ЕСТЬNULL(Характеристики.Ссылка, ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)) КАК Характеристика
ПОМЕСТИТЬ НоменклатураХарактеристики
ИЗ
	ТаблицаНоменклатуры КАК ТаблицаНоменклатуры
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ХарактеристикиНоменклатуры КАК Характеристики
		ПО ТаблицаНоменклатуры.Ссылка = Характеристики.Владелец
			И (ТаблицаНоменклатуры.ИспользоватьХарактеристики = ИСТИНА)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаНоменклатуры.Ссылка КАК Ссылка,
	ТаблицаНоменклатуры.ИспользоватьХарактеристики КАК ИспользоватьХарактеристики,
	ТаблицаНоменклатуры.КатегорияНоменклатуры КАК КатегорияНоменклатуры,
	ЕСТЬNULL(Характеристики.Ссылка, ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка)) КАК Характеристика
ПОМЕСТИТЬ КатегорияНоменклатурыХарактеристики
ИЗ
	ТаблицаНоменклатуры КАК ТаблицаНоменклатуры
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ХарактеристикиНоменклатуры КАК Характеристики
		ПО ТаблицаНоменклатуры.КатегорияНоменклатуры = Характеристики.Владелец
			И (ТаблицаНоменклатуры.ИспользоватьХарактеристики = ИСТИНА)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаНоменклатуры.Ссылка КАК Номенклатура,
	ТаблицаНоменклатуры.Ссылка.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТаблицаНоменклатуры.Характеристика КАК Характеристика
ПОМЕСТИТЬ НоменклатураСХарактеристиками
ИЗ
	ТаблицаНоменклатуры КАК ТаблицаНоменклатуры

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	НоменклатураХарактеристики.Ссылка,
	НоменклатураХарактеристики.Ссылка.ЕдиницаИзмерения,
	НоменклатураХарактеристики.Характеристика
ИЗ
	НоменклатураХарактеристики КАК НоменклатураХарактеристики

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	КатегорияНоменклатурыХарактеристики.Ссылка,
	КатегорияНоменклатурыХарактеристики.Ссылка.ЕдиницаИзмерения,
	КатегорияНоменклатурыХарактеристики.Характеристика
ИЗ
	КатегорияНоменклатурыХарактеристики КАК КатегорияНоменклатурыХарактеристики
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НоменклатураСХарактеристиками.Номенклатура КАК Номенклатура,
	НоменклатураСХарактеристиками.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	НоменклатураСХарактеристиками.Характеристика КАК Характеристика
ИЗ
	НоменклатураСХарактеристиками КАК НоменклатураСХарактеристиками
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗапасыОстатки.Организация КАК Организация,
	ЗапасыОстатки.СтруктурнаяЕдиница КАК Склад,
	ЗапасыОстатки.Номенклатура КАК Номенклатура,
	ЗапасыОстатки.Характеристика КАК Характеристика,
	ЗапасыОстатки.Партия КАК Партия,
	ЗапасыОстатки.СчетУчета КАК СчетУчета,
	ЗапасыОстатки.КоличествоОстаток КАК КоличествоОстаток,
	ЗапасыОстатки.СуммаОстаток КАК СуммаОстаток
ПОМЕСТИТЬ ТаблицаОстатков
ИЗ
	РегистрНакопления.Запасы.Остатки(
			,
			(Номенклатура, Характеристика) В
				(ВЫБРАТЬ
					Т.Номенклатура,
					Т.Характеристика
				ИЗ
					НоменклатураСХарактеристиками КАК Т)) КАК ЗапасыОстатки

ИНДЕКСИРОВАТЬ ПО
	Номенклатура,
	Характеристика
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МАКСИМУМ(ЦеныНоменклатуры.Период) КАК Период,
	ЦеныНоменклатуры.ВидЦен КАК ВидЦен,
	ЦеныНоменклатуры.Номенклатура КАК Номенклатура,
	ЦеныНоменклатуры.Характеристика КАК Характеристика,
	ЦеныНоменклатуры.Цена КАК Цена
ПОМЕСТИТЬ ТаблицаЦен
ИЗ
	РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
			,
			(Номенклатура, Характеристика) В
				(ВЫБРАТЬ
					Т.Номенклатура,
					Т.Характеристика
				ИЗ
					НоменклатураСХарактеристиками КАК Т)) КАК ЦеныНоменклатуры

СГРУППИРОВАТЬ ПО
	ЦеныНоменклатуры.ВидЦен,
	ЦеныНоменклатуры.Номенклатура,
	ЦеныНоменклатуры.Характеристика,
	ЦеныНоменклатуры.Цена
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	НоменклатураСХарактеристиками.Номенклатура КАК Номенклатура,
	НоменклатураСХарактеристиками.Номенклатура.КатегорияНоменклатуры КАК КатегорияНоменклатуры,
	НоменклатураСХарактеристиками.Номенклатура.ЦеноваяГруппа КАК ЦеноваяГруппа,
	НоменклатураСХарактеристиками.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	НоменклатураСХарактеристиками.Характеристика КАК Характеристика,
	ТаблицаОстатков.Организация КАК Организация,
	ТаблицаОстатков.Партия КАК Партия,
	ТаблицаОстатков.СчетУчета КАК СчетУчета,
	ТаблицаОстатков.Склад КАК Склад,
	ЕСТЬNULL(ТаблицаОстатков.КоличествоОстаток, 0) КАК КоличествоОстаток,
	ЕСТЬNULL(ТаблицаОстатков.СуммаОстаток, 0) КАК СуммаОстаток,
	ЕСТЬNULL(ТаблицаЦен.Период, ДАТАВРЕМЯ(1, 1, 1)) КАК ПоследняяДатаУстановкиЦены,
	ЕСТЬNULL(ТаблицаЦен.ВидЦен, ЗНАЧЕНИЕ(Справочник.ВидыЦен.ПустаяСсылка)) КАК ВидЦенУстановлен,
	ЕСТЬNULL(ТаблицаЦен.Цена, 0) КАК Цена
ПОМЕСТИТЬ ТаблицаРезультат
ИЗ
	НоменклатураСХарактеристиками КАК НоменклатураСХарактеристиками
		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОстатков КАК ТаблицаОстатков
		ПО НоменклатураСХарактеристиками.Номенклатура = ТаблицаОстатков.Номенклатура
			И НоменклатураСХарактеристиками.Характеристика = ТаблицаОстатков.Характеристика
		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаЦен КАК ТаблицаЦен
		ПО НоменклатураСХарактеристиками.Номенклатура = ТаблицаЦен.Номенклатура
			И НоменклатураСХарактеристиками.Характеристика = ТаблицаЦен.Характеристика
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаРезультат.Номенклатура КАК Номенклатура,
	ТаблицаРезультат.КатегорияНоменклатуры КАК КатегорияНоменклатуры,
	ТаблицаРезультат.ЦеноваяГруппа КАК ЦеноваяГруппа,
	ТаблицаРезультат.ЕдиницаИзмерения КАК ЕдиницаИзмерения,
	ТаблицаРезультат.Характеристика КАК Характеристика,
	ТаблицаРезультат.Организация КАК Организация,
	ТаблицаРезультат.Партия КАК Партия,
	ТаблицаРезультат.СчетУчета КАК СчетУчета,
	ТаблицаРезультат.Склад КАК Склад,
	ТаблицаРезультат.КоличествоОстаток КАК КоличествоОстаток,
	ТаблицаРезультат.СуммаОстаток КАК СуммаОстаток,
	ТаблицаРезультат.ПоследняяДатаУстановкиЦены КАК ПоследняяДатаУстановкиЦены,
	ТаблицаРезультат.ВидЦенУстановлен КАК УстановленаЦенаПоВидуЦен,
	ТаблицаРезультат.Цена КАК Цена
ИЗ
	ТаблицаРезультат КАК ТаблицаРезультат

УПОРЯДОЧИТЬ ПО
	ТаблицаРезультат.Номенклатура.Наименование</query>
	</dataSet>
	<parameter>
		<name>Период</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:filter>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Номенклатура</dcsset:left>
					<dcsset:comparisonType>InHierarchy</dcsset:comparisonType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Склад</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">КоличествоОстаток</dcsset:left>
					<dcsset:comparisonType>Greater</dcsset:comparisonType>
					<dcsset:right xsi:type="xs:decimal">0</dcsset:right>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">ЦеноваяГруппа</dcsset:left>
					<dcsset:comparisonType>InList</dcsset:comparisonType>
					<dcsset:right xsi:type="v8:ValueListType">
						<v8:lastId xsi:type="xs:decimal">-1</v8:lastId>
					</dcsset:right>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">КатегорияНоменклатуры</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemGroup">
					<dcsset:use>false</dcsset:use>
					<dcsset:groupType>AndGroup</dcsset:groupType>
					<dcsset:item xsi:type="dcsset:FilterItemComparison">
						<dcsset:use>false</dcsset:use>
						<dcsset:left xsi:type="dcscor:Field">УстановленаЦенаПоВидуЦен</dcsset:left>
						<dcsset:comparisonType>InList</dcsset:comparisonType>
						<dcsset:right xsi:type="v8:ValueListType">
							<v8:lastId xsi:type="xs:decimal">-1</v8:lastId>
						</dcsset:right>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:FilterItemComparison">
						<dcsset:use>false</dcsset:use>
						<dcsset:left xsi:type="dcscor:Field">ПоследняяДатаУстановкиЦены</dcsset:left>
						<dcsset:comparisonType>Filled</dcsset:comparisonType>
					</dcsset:item>
					<dcsset:item xsi:type="dcsset:FilterItemComparison">
						<dcsset:use>false</dcsset:use>
						<dcsset:left xsi:type="dcscor:Field">Цена</dcsset:left>
						<dcsset:comparisonType>Filled</dcsset:comparisonType>
					</dcsset:item>
				</dcsset:item>
			</dcsset:filter>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>